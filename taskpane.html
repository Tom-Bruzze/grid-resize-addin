<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Grid Resize Tool</title>
    <link rel="stylesheet" href="taskpane.css">
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</head>
<body>
<div class="app">

    <!-- HEADER -->
    <div class="hdr">
        <div class="logo">▦</div>
        <div><strong>Grid Resize by Droege Group</strong><br><span class="sub">v2.1 · RE-basiert</span></div>
    </div>

    <!-- RASTEREINHEIT -->
    <div class="grid-bar">
        <label>RE</label>
        <button class="pre" data-value="0.10">0,10</button>
        <button class="pre active" data-value="0.21">0,21</button>
        <button class="pre" data-value="0.50">0,50</button>
        <button class="pre" data-value="1.00">1,00</button>
        <input type="number" id="gridUnit" value="0.21" step="0.01" min="0.01">
        <span class="cm">cm</span>
    </div>

    <!-- STATUS -->
    <div class="sts" id="status">Bereit</div>

    <!-- TABS: 3 Tabs -->
    <div class="tabs">
        <button class="tab active" data-tab="tools">Tools</button>
        <button class="tab" data-tab="extras">Extras</button>
        <button class="tab" data-tab="gantt">Gantt</button>
    </div>

    <!-- ═══════════════ PANE: TOOLS ═══════════════ -->
    <div class="pane active" id="tools">

        <!-- Größe -->
        <div class="sec">
            <div class="sec-head">Größe <span class="hint">Klick + | Shift −</span></div>
            <div class="g4">
                <button id="resizeW" class="sq grn">
                    <svg viewBox="0 0 20 20"><line x1="3" y1="10" x2="17" y2="10"/><line x1="3" y1="7" x2="3" y2="13"/><line x1="17" y1="7" x2="17" y2="13"/></svg>
                    <span>W</span>
                </button>
                <button id="resizeH" class="sq grn">
                    <svg viewBox="0 0 20 20"><line x1="10" y1="3" x2="10" y2="17"/><line x1="7" y1="3" x2="13" y2="3"/><line x1="7" y1="17" x2="13" y2="17"/></svg>
                    <span>H</span>
                </button>
                <button id="resizeBoth" class="sq grn">
                    <svg viewBox="0 0 20 20"><rect x="4" y="4" width="12" height="12" rx="1"/></svg>
                    <span>W+H</span>
                </button>
                <button id="resizeProp" class="sq grn">
                    <svg viewBox="0 0 20 20"><circle cx="10" cy="10" r="6"/><line x1="14" y1="14" x2="17" y2="17"/></svg>
                    <span>Prop</span>
                </button>
            </div>
        </div>

        <!-- Angleichen -->
        <div class="sec">
            <div class="sec-head">Angleichen <span class="hint">Klick Max | Shift Min</span></div>
            <div class="g4">
                <button id="matchW" class="sq pur">
                    <svg viewBox="0 0 20 20"><line x1="3" y1="10" x2="17" y2="10"/><line x1="3" y1="7" x2="3" y2="13"/><line x1="17" y1="7" x2="17" y2="13"/></svg>
                    <span>W</span>
                </button>
                <button id="matchH" class="sq pur">
                    <svg viewBox="0 0 20 20"><line x1="10" y1="3" x2="10" y2="17"/><line x1="7" y1="3" x2="13" y2="3"/><line x1="7" y1="17" x2="13" y2="17"/></svg>
                    <span>H</span>
                </button>
                <button id="matchBoth" class="sq pur">
                    <svg viewBox="0 0 20 20"><rect x="4" y="4" width="12" height="12" rx="1"/></svg>
                    <span>W+H</span>
                </button>
                <button id="matchProp" class="sq pur">
                    <svg viewBox="0 0 20 20"><circle cx="10" cy="10" r="6"/><line x1="14" y1="14" x2="17" y2="17"/></svg>
                    <span>Prop</span>
                </button>
            </div>
        </div>

        <!-- Raster & Abstände -->
        <div class="sec">
            <div class="sec-head">Raster & Abstände</div>

            <div class="row-label">Einrasten</div>
            <div class="g4" style="margin-bottom:6px">
                <button id="snapPos" class="sq blu">
                    <svg viewBox="0 0 20 20"><circle cx="5" cy="10" r="2"/><line x1="9" y1="10" x2="17" y2="10"/><line x1="14" y1="7" x2="17" y2="10"/><line x1="14" y1="13" x2="17" y2="10"/></svg>
                    <span>Pos</span>
                </button>
                <button id="snapSize" class="sq blu">
                    <svg viewBox="0 0 20 20"><rect x="4" y="6" width="12" height="8" rx="1"/></svg>
                    <span>Size</span>
                </button>
                <button id="snapAll" class="sq blu">
                    <svg viewBox="0 0 20 20"><rect x="4" y="4" width="12" height="12" rx="1"/><line x1="10" y1="1" x2="10" y2="4"/><line x1="10" y1="16" x2="10" y2="19"/><line x1="1" y1="10" x2="4" y2="10"/><line x1="16" y1="10" x2="19" y2="10"/></svg>
                    <span>Alles</span>
                </button>
                <button id="showInfo" class="sq blu-d">
                    <svg viewBox="0 0 20 20"><circle cx="10" cy="5" r="1.5"/><line x1="10" y1="9" x2="10" y2="16"/></svg>
                    <span>Info</span>
                </button>
            </div>

            <div class="row-label">Abstand = 1 RE</div>
            <div class="g4">
                <button id="spaceH" class="sq amb">
                    <svg viewBox="0 0 20 20"><rect x="2" y="5" width="5" height="10" rx="1"/><rect x="13" y="5" width="5" height="10" rx="1"/><line x1="9" y1="10" x2="11" y2="10" stroke-dasharray="1,1"/></svg>
                    <span>H</span>
                </button>
                <button id="spaceV" class="sq amb">
                    <svg viewBox="0 0 20 20"><rect x="5" y="2" width="10" height="5" rx="1"/><rect x="5" y="13" width="10" height="5" rx="1"/><line x1="10" y1="9" x2="10" y2="11" stroke-dasharray="1,1"/></svg>
                    <span>V</span>
                </button>
            </div>

            <div class="info-box" id="infoBox"></div>
        </div>

        <!-- Grid-Tabelle -->
        <div class="sec">
            <div class="sec-head">Grid-Tabelle</div>
            <div class="tbl-inline">
                <label>Sp</label><input type="number" id="tCols" value="5" min="1" max="15">
                <label>Zl</label><input type="number" id="tRows" value="3" min="1" max="20">
                <label>B</label><input type="number" id="tCW" value="10" min="1">
                <label>H</label><input type="number" id="tCH" value="5" min="1">
                <button id="createTable" class="sq teal" style="min-width:38px">
                    <svg viewBox="0 0 20 20"><rect x="3" y="3" width="14" height="14" rx="1"/><line x1="3" y1="10" x2="17" y2="10"/><line x1="10" y1="3" x2="10" y2="17"/></svg>
                    <span>Go</span>
                </button>
            </div>
        </div>
    </div>

    <!-- ═══════════════ PANE: EXTRAS ═══════════════ -->
    <div class="pane" id="extras">

        <!-- Papierformat -->
        <div class="sec">
            <div class="sec-head">Papierformat</div>
            <button id="setSlide" class="sq-wide teal">
                <svg viewBox="0 0 20 20"><rect x="2" y="4" width="16" height="12" rx="1"/></svg>
                27,728 × 19,297 cm
            </button>
        </div>

        <!-- Hilfslinien -->
        <div class="sec">
            <div class="sec-head">Hilfslinien (Master)</div>
            <button id="toggleGuides" class="sq-wide drk">
                <svg viewBox="0 0 20 20"><line x1="10" y1="2" x2="10" y2="18"/><line x1="2" y1="10" x2="18" y2="10"/></svg>
                Ein-/Ausblenden
            </button>
            <div class="guide-info">V: <b>8</b>, <b>126 RE</b> · H: <b>5</b>, <b>9</b>, <b>15</b>, <b>17</b>, <b>86 RE</b></div>
        </div>

        <!-- Schatten-Werte -->
        <div class="sec">
            <div class="sec-head">Schatten-Werte</div>
            <div class="shadow-grid">
                <span>Farbe</span><span>Schwarz</span>
                <span>Transparenz</span><span>75 %</span>
                <span>Größe</span><span>100 %</span>
                <span>Weichzeichnen</span><span>4 pt</span>
                <span>Winkel</span><span>90°</span>
                <span>Abstand</span><span>1 pt</span>
            </div>
            <button id="copyShadow" class="sq-wide drk" style="margin-top:4px">
                <svg viewBox="0 0 20 20"><rect x="6" y="2" width="10" height="13" rx="1"/><rect x="4" y="5" width="10" height="13" rx="1"/></svg>
                Werte kopieren
            </button>
        </div>
    </div>

    <!-- ═══════════════ PANE: GANTT ═══════════════ -->
    <div class="pane" id="gantt">

        <!-- Zeitraum -->
        <div class="sec">
            <div class="sec-head">Zeitraum</div>
            <div class="gantt-row">
                <label>Von</label>
                <select id="gStartM"></select>
                <input type="number" id="gStartY" value="2025" min="2020" max="2035" class="gantt-yr">
            </div>
            <div class="gantt-row" style="margin-top:3px">
                <label>Bis</label>
                <select id="gEndM"></select>
                <input type="number" id="gEndY" value="2025" min="2020" max="2035" class="gantt-yr">
            </div>
        </div>

        <!-- Aufgaben -->
        <div class="sec">
            <div class="sec-head">Aufgaben <span class="hint">Name | Start | Ende</span></div>
            <div id="ganttTasks">
                <!-- Dynamisch befüllt -->
            </div>
            <div class="gantt-row" style="margin-top:4px;gap:4px">
                <button id="ganttAddTask" class="sq teal" style="width:auto;padding:0 10px;height:28px">
                    <svg viewBox="0 0 20 20" style="width:14px;height:14px"><line x1="10" y1="4" x2="10" y2="16"/><line x1="4" y1="10" x2="16" y2="10"/></svg>
                    <span>Zeile</span>
                </button>
                <button id="ganttRmTask" class="sq drk" style="width:auto;padding:0 10px;height:28px">
                    <svg viewBox="0 0 20 20" style="width:14px;height:14px"><line x1="4" y1="10" x2="16" y2="10"/></svg>
                    <span>−</span>
                </button>
            </div>
        </div>

        <!-- Layout -->
        <div class="sec">
            <div class="sec-head">Layout</div>
            <div class="gantt-row">
                <label>Farbe</label>
                <input type="color" id="gBarColor" value="#e94560" class="gantt-color">
                <label style="margin-left:6px">Höhe</label>
                <select id="gBarH" class="gantt-sel">
                    <option value="2">2 RE</option>
                    <option value="3" selected>3 RE</option>
                    <option value="4">4 RE</option>
                    <option value="5">5 RE</option>
                </select>
            </div>
            <div class="gantt-row" style="margin-top:3px">
                <label>Header</label>
                <select id="gHeaderStyle" class="gantt-sel">
                    <option value="month">Monat</option>
                    <option value="quarter">Quartal</option>
                </select>
                <label style="margin-left:6px">Lücke</label>
                <select id="gGap" class="gantt-sel">
                    <option value="0">0 RE</option>
                    <option value="1" selected>1 RE</option>
                    <option value="2">2 RE</option>
                </select>
            </div>
        </div>

        <!-- Erstellen -->
        <div class="sec">
            <button id="ganttBuild" class="sq-wide teal">
                <svg viewBox="0 0 20 20"><rect x="2" y="3" width="16" height="3" rx="1"/><rect x="6" y="8" width="12" height="3" rx="1"/><rect x="4" y="13" width="10" height="3" rx="1"/></svg>
                Gantt-Chart erstellen
            </button>
        </div>

    </div>

</div>
<script src="taskpane.js"></script>
</body>
</html>